---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# fivbvis

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
<!-- badges: end -->

R package for getting data from [FIVB VIS web server](https://www.fivb.org/VisSDK/VisWebService/#Introduction.html)

## Installation

You can install the development version of fivbvis like so:

``` r
install.packages("remotes") ## if needed
remotes::install_github("wehsLai/fivbvis")
```

## Example

This is a basic example which shows you how to get data:

By default, results are cached in a per-session cache, so if we make the same request again the local results are used, rather than re-downloading.

### 1. Tournaments List with Filter

```{r example1}
library(fivbvis) # load package

pl <- list(Fields = "No ShortNameOrName Season DefaultPlayersRanking")
cl <- list(Filter = c(Seasons = "2021"))
vb_tournaments <- v_get_volley_tournament_list(parent = pl, children = cl)
vb_tournaments
```

### 2. Matches List with Filter

```{r example2}
s_tournament <- vb_tournaments[vb_tournaments$shortNameOrName == "FIVB VNL MEN", ]
pl <- list(Fields = "DateTimeLocal PoolName, TeamAName TeamBName MatchResultText")
cl <- list(Filter = c(NoTournament = s_tournament$no))
v_get_volley_match_list(parent = pl, children = cl)
```

### 3. Pools List with Filter

```{r example3}
pl <- list(Fields = "Name RoundName")
cl <- list(Filter = c(NoTournament = s_tournament$no, ForRanking = NULL))
v_get_volley_pool_list(parent=pl, children = cl)
```

### 4. Teams List with Filter

```{r example4}
pl <- list(Fields = "Code Name")
cl <- list(Filter = c(NoTournament = s_tournament$no))
v_get_volley_team_list(parent = pl, children = cl)
```

### 5. Players List with Filter

```{r example5}
pl <- list(Fields = "Team NoShirt FirstNamePlayer LastNamePlayer Position")
cl <- list(Filter = c(NoTournament = s_tournament$no))
v_get_volley_player_list(parent = pl, children = cl)
```

### 6. Statistics List with Filter, Relation

```{r example6}
pl <- list(Fields = "BlockPoint BlockFault BlockContinue BlockTotal",
           SumBy = "Tournament")
cl <- list(Filter = c(NoTournaments = s_tournament$no, MatchesToUse="MatchesFinished"),
           Relation = c(Name="Match", Fields="NoInTournament DateLocal TeamACode TeamBCode MatchResult"),
           Relation = c(Name="Team", Fields="Code Name"),
           Relation = c(Name="Player", Fields="TeamName FirstName LastName VolleyPosition"))
v_get_volley_statistic_list(parent = pl, children = cl)
```

### 7. Pool Ranking

```{r example7}
pl <- list(Fields = "No")
cl <- list(Filter = c(NoTournament = s_tournament$no, ForRanking=TRUE))
vb_pools_frk <- v_get_volley_pool_list(parent=pl, children = cl)
if(length(vb_pools_frk) > 0) {
  pl <- list(NoPool = vb_pools_frk$no[1], 
             Fields = "RankTextWithRepeat TeamCode MatchPoints MatchesWon MatchesLost Matches")
  v_get_volley_pool_ranking(parent = pl)
}
```

### 8. Tournament Ranking

```{r example8}
pl <- list(NoTournament = s_tournament$no, 
           Fields = "RankTextWithRepeat TeamName")
v_get_volley_tournament_ranking(parent = pl)
```

### 9. Player Spike Ranking

```{r example9}
if(!is.na(s_tournament$defaultPlayersRanking)) {
  pl <- list(No = s_tournament$defaultPlayersRanking, 
             NumberOfScorers = 10, NumberOfPlayers = 10, Skills = "Spike")
  vb_players_ranking <- v_get_volley_player_ranking(parent = pl)
  vb_players_ranking$Spike[c("TeamCode", "FirstName", "LastName", "Successes", "Faults", "Continues", "TotalAttempts", "Note")]
}
```

